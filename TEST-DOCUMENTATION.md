# Test Documentation

## Test Coverage Summary

### Unit Tests (Angular/Karma)
- **Framework**: Karma + Jasmine
- **Coverage**: Components, Services, Utilities
- **Run Command**: `npm run test`

### End-to-End Tests (Playwright)

#### Test Suites

**1. Core Functionality (`chatbot.spec.ts`)**
- ✅ Chat interface loading and visibility
- ✅ AI greeting message display
- ✅ User message sending (button and Enter key)
- ✅ AI response reception
- ✅ Typing indicators
- ✅ Chat history maintenance
- ✅ Input validation
- ✅ Auto-scrolling behavior

**2. Responsive Design (`responsive.spec.ts`)**
- ✅ Desktop layout (1920x1080)
- ✅ Tablet layout (768x1024)
- ✅ Mobile layout (375x812)
- ✅ Touch interactions
- ✅ Virtual keyboard handling

**3. SignalR Integration (`signalr.spec.ts`)**
- ✅ Connection establishment
- ✅ Reconnection handling
- ✅ Multiple rapid messages
- ✅ Special character handling
- ✅ Long message support

**4. Accessibility (`accessibility.spec.ts`)**
- ✅ ARIA labels and roles
- ✅ Keyboard navigation
- ✅ Screen reader support
- ✅ Color contrast verification

### Browser Support

| Browser | Desktop | Mobile | Status |
|---------|---------|---------|---------|
| Chrome | ✅ | ✅ | Fully Supported |
| Firefox | ✅ | ❌ | Desktop Only |
| Safari | ✅ | ✅ | Fully Supported |
| Edge | ⚠️ | ❌ | Manual Testing |

### Test Commands

```bash
# Unit tests
npm run test

# E2E tests (headless)
npm run e2e

# E2E tests with UI
npm run e2e:ui

# E2E tests in headed mode
npm run e2e:headed

# Debug E2E tests
npm run e2e:debug

# All tests
npm run test:all
```

### Test Environment Setup

1. **Prerequisites**:
   - Node.js 18+
   - .NET 8 SDK
   - Chrome/Firefox/Safari browsers

2. **Installation**:
   ```bash
   cd chatbot-frontend
   npm install
   npx playwright install
   ```

3. **Configuration**:
   - Backend runs on `https://localhost:7271`
   - Frontend runs on `http://localhost:4200`
   - Tests automatically start both servers

### Continuous Integration

The project includes GitHub Actions workflows that:
- Run unit tests on every push/PR
- Execute E2E tests on multiple browsers
- Generate test reports and artifacts
- Perform build validation

### Test Reports

- **Unit Test Reports**: Generated by Karma (coverage reports in `coverage/` directory)
- **E2E Test Reports**: Generated by Playwright (HTML reports in `playwright-report/` directory)
- **Screenshots**: Captured on test failures
- **Videos**: Recorded for failed test scenarios

### Known Limitations

1. **Mock AI Responses**: Tests use mock AI service for predictable responses
2. **Network Dependencies**: Some tests may be affected by network conditions
3. **Browser Timing**: Occasional timing issues with rapid message sending

### Future Test Enhancements

- [ ] Visual regression testing
- [ ] Performance testing
- [ ] Load testing for concurrent users
- [ ] Integration tests with real Azure OpenAI
- [ ] API contract testing
- [ ] Security testing (XSS, CSRF)

### Troubleshooting

**Common Issues:**

1. **Port conflicts**: Ensure ports 4200 and 7271 are available
2. **Browser installation**: Run `npx playwright install` if browsers are missing
3. **Timeout errors**: Increase timeout values in `playwright.config.ts` for slower systems
4. **Mock responses**: Verify mock service is working if AI responses fail

**Debug Tips:**

- Use `--headed` flag to see browser actions
- Use `--debug` flag to step through tests
- Check browser console logs for JavaScript errors
- Verify SignalR connection in Network tab
